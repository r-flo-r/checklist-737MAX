<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>iFly 737 MAX 8 Checklist</title>
<style>
  :root {
    --bg: #121212;
    --card: #1e1e1e;
    --muted: #aaa;
    --line: #2b2b2b;
    --text: #f0f0f0;
    --accent: #2e8bff;
  }

  body {
    margin: 0;
    font-family: Inter, Arial, Helvetica, sans-serif;
    background: var(--bg);
    color: var(--text);
    padding: 20px;
    -webkit-font-smoothing:antialiased;
  }

  .container {
    max-width: 980px;
    margin: 0 auto;
    background: var(--card);
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 8px 30px rgba(0,0,0,0.6);
  }

  .header {
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap: 12px;
    margin-bottom: 14px;
  }

  h1 {
    margin: 0;
    font-size: 1.4rem;
    letter-spacing: 0.2px;
  }

  #resetBtn {
    background: transparent;
    border: 1px solid #444;
    color: var(--text);
    padding: 8px 12px;
    border-radius: 8px;
    cursor: pointer;
  }
  #resetBtn:hover { background: rgba(255,255,255,0.03); border-color:#666; }

  h2 {
    margin: 18px 0 8px 0;
    font-size: 1.15rem;
    color: var(--text);
  }

  table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 8px;
    table-layout: fixed;
  }

  th, td {
    padding: 8px 10px;
    vertical-align: middle;
    color: var(--text);
    word-wrap: break-word;
  }

  tr { border-bottom: 1px solid var(--line); }

  td.checkbox {
    width: 64px; /* Platz für große Checkbox */
  }
  td.item {
    width: calc(50% - 64px);
    padding-right: 12px;
  }
  td.action {
    width: calc(50% - 64px);
    color: var(--muted);
  }

  input[type="checkbox"] {
    width: 35px;
    height: 35px;
    cursor: pointer;
    margin: 0;
    display: inline-block;
    vertical-align: middle;
  }

  /* Label für Item klickbar machen */
  label.item-label {
    cursor: pointer;
    display: inline-block;
    line-height: 1.2;
    color: var(--text);
  }

  tr.subsection td {
    text-align: center;
    font-style: italic;
    color: #cfcfcf;
    background: rgba(255,255,255,0.008);
    border-bottom: 1px solid rgba(255,255,255,0.02);
  }

  /* responsive */
  @media (max-width: 720px) {
    td.checkbox { width: 52px; }
    td.item, td.action { display: block; width: 100%; }
    table { display: block; }
    tr { display:block; padding:6px 0; border-bottom:1px solid var(--line); }
    tr.subsection td { display:block; padding:8px 0; }
    td.checkbox { display:flex; align-items:center; gap:8px; padding-bottom:6px; }
  }
</style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>iFly 737 MAX 8 Checklist</h1>
      <button id="resetBtn" type="button">Reset</button>
    </div>

    <div id="checklist" aria-live="polite"></div>
  </div>

<script>
(function(){
  // --- Daten: alle Abschnitte und Items (Subsections beginnen/enden mit '-')
  const checklistData = [
    {
      section: "PREFLIGHT",
      items: [
        ["PARKING BRAKE","SET"],
        ["BATTERY SWITCH","ON AND COVERED"],
        ["GROUND POWER","CONNECTED AND ON"],
        ["IRS SELECTOR (L & R)","NAV"],
        ["CABIN/UTILITY","ON"],
        ["IFE PASS SEAT POWER","ON"],
        ["EMERGENCY LIGHTS","ARMED"],
        ["POSITION LIGHTS","STEADY"],
        ["WINDOWS HEAT","ON"],
        ["TRIM AIR","ON"],
        ["RECIRC FAN","AUTO"],
        ["PACKS (L & R)","AUTO"],
        ["ISOLATION VALVE","OPEN"],
        ["PRESSURIZZATION PANEL","AUTO"],
        ["FUEL PUMP FWD 1","ON"],
        ["ALTIMETERS","SET"],
        ["TRANSPONDER","SET ALT OFF"],
        ["FLIGHT DIRECTORS","ON"],
        ["FMC","SETUP"],
        ["MCP","V2 - HDG - ALTITUDE"],
        ["LNAV & VNAV","ARMED"],
        ["APU","ON – START - ON"],
        ["APU GEN","ON"],
        ["APU BLEED","ON"]
      ]
    },
    {
      section: "BEFORE START",
      items: [
        ["GROUND POWER","DISCONNECTED AND OFF"],
        ["FLIGHT DECK DOORS","CLOSED AND LOCKED"],
        ["YAW DUMPER","ON"],
        ["PROBE HEAT","ON"],
        ["HYD PUMPS","ON"],
        ["FUEL PUMPS","ON"],
        ["PASSENGER SIGNS","ON/AUTO"],
        ["ANTI COLLISION LIGHTS","ON"],
        ["PACKS (L & R)","OFF"],
        ["ENGINES START","START N2 THEN N1"]
      ]
    },
    {
      section: "BEFORE TAXI",
      items: [
        ["ENGINE GEN (1 & 2)","ON"],
        ["ANTI-ICE","AS REQUIRED"],
        ["AUTOBRAKE","RTO"],
        ["FLAPS","SET"],
        ["TRIM","SET"],
        ["APU","OFF"],
        ["APU BLEED","OFF"],
        ["PACKS (L & R)","ON"],
        ["ISOLATION VALVE","AUTO"],
        ["FLIGHT CONTROLS","CHECKED"],
        ["TAXI LIGHTS","ON"],
        ["RWY TURN-OFF LIGHTS","AS REQUIRED"]
      ]
    },
    {
      section: "BEFORE TAKEOFF",
      items: [
        ["PARKING BRAKE","SET"],
        ["AUTOTHROTTLE","ARM"],
        ["TAKE OFF DATA ( V1 VR V2 )","CHECK"],
        ["SET TERRAIN & WEATHER DISPLAY","AS NEEDED"],
        ["LANDING LIGHTS","ON"],
        ["POSITION LIGHTS","STROBE & STEADY"],
        ["TAXI LIGHTS","OFF"],
        ["TRANSPONDER","TA/RA"],
        ["CLOCK","START"]
      ]
    },
    {
      section: "AFTER TAKEOFF",
      items: [
        ["POSITIVE RATE OF CLIMB","GEAR UP"],
        ["AUTOBRAKE","OFF"],
        ["RWY TURN-OFF LIGHTS","OFF"],
        ["FLAPS","RETRACT ON SCHEDULE"],
        ["AUTOPILOT","ENGAGE"]
      ]
    },
    {
      section: "CLIMB",
      items: [
        ["ALTIMETER","SET STD"],
        ["-Passing 10000 ft-",""],
        ["LANDING LIGHTS","OFF"],
        ["SEATBELTS SIGN","OFF"]
      ]
    },
    {
      section: "DESCEND",
      items: [
        ["ANTI-ICE","AS REQUIRED"],
        ["RECALL","CHECK"],
        ["LANDING ALT","SET"],
        ["APPROACH BRIEFING","COMPLETE"],
        ["-Passing TL-",""],
        ["ALTIMETER","LOCAL QNH"],
        ["-Below 10000 ft-",""],
        ["LANDING LIGHTS","ON"],
        ["SEATBELTS SIGN","ON"]
      ]
    },
    {
      section: "APPROACH",
      items: [
        ["ALTIMETER","CHECK"],
        ["DH/DA","SET"],
        ["APPROACH SPEED (FMC)","SET & CHECK"],
        ["APPROACH DATA (ILS AND COURSE)","SET"],
        ["APPROACH BUTTON","ARM"],
        ["SPEEDBRAKE","ARM"],
        ["AUTOBRAKE","AS REQUIRED"],
        ["FLAPS","SET"]
      ]
    },
    {
      section: "LANDING",
      items: [
        ["GO AROUND ALTITUDE","SET"],
        ["LANDING GEAR","DOWN"],
        ["LANDING FLAPS","SET"]
      ]
    },
    {
      section: "AFTER LANDING",
      items: [
        ["AUTOBRAKE","OFF"],
        ["FLAPS","RETRACT"],
        ["SPEEDBRAKES","DOWN"],
        ["LANDING LIGHTS","OFF"],
        ["STROBE LIGHTS","STEADY"],
        ["TAXI LIGHTS","ON"],
        ["TRANSPONDER","ALT OFF"],
        ["APU","AS REQ"],
        ["APU GEN","ON"],
        ["TERRAIN & WEATHER DISPLAY","OFF"],
        ["CLOCK","STOP"]
      ]
    },
    {
      section: "PARKING - SHUTDOWN",
      items: [
        ["PARKING BRAKE","SET"],
        ["TAXI LIGHTS","OFF"],
        ["CHOCKS","SET"],
        ["EXTERNAL POWER","CONNECTED AND ON"],
        ["APU","OFF"],
        ["FUEL CONTROL SWITCHES","CUTOFF"],
        ["ANTI COLLISION LIGHTS","OFF"],
        ["FLIGHT DIRECTORS","OFF"],
        ["PASSENGER SIGNS","OFF"],
        ["YAW DUMPER","OFF"],
        ["HYDRAULIC PUMPS","OFF"],
        ["FUEL PUMPS","OFF"],
        ["PROBE HEAT","OFF"],
        ["DOORS","OPEN"]
      ]
    },
    {
      section: "SECURE AIRCRAFT",
      items: [
        ["IRS SELECTOR (L & R)","OFF"],
        ["EMERGENCY LIGHTS","OFF"],
        ["TRIM AIR","OFF"],
        ["RECIRC FAN","OFF"],
        ["PACKS (L & R)","OFF"],
        ["ISOLATION VALVE","OPEN"],
        ["LOGO LIGHTS","OFF"],
        ["POSITION LIGHTS","OFF"],
        ["WINDOWS HEAT","OFF"],
        ["CABIN/UTILITY","OFF"],
        ["IFE PASS SEAT POWER","OFF"],
        ["BATTERY SWITCH","OFF"]
      ]
    }
  ];

  // --- Rendering / Storage ---
  const checklistEl = document.getElementById('checklist');
  const prefix = 'ifly737max8_full_'; // key prefix for localStorage

  function isSubsection(text){
    // Erkennung: beginnt und endet mit '-' (z.B. "-Passing TL-")
    return /^\s*-.*-\s*$/.test(text);
  }

  function trimHyphens(text){
    return text.replace(/^\s*-+\s*/, '').replace(/\s*-+\s*$/, '');
  }

  function buildChecklist() {
    checklistEl.innerHTML = '';
    checklistData.forEach((section, sIdx) => {
      const h2 = document.createElement('h2');
      h2.textContent = section.section;
      checklistEl.appendChild(h2);

      const table = document.createElement('table');
      // optional: header row (hidden visually) - omitted to keep compact

      section.items.forEach((item, i) => {
        const tr = document.createElement('tr');

        if (isSubsection(item[0])) {
          tr.classList.add('subsection');
          const td = document.createElement('td');
          td.colSpan = 3;
          td.textContent = trimHyphens(item[0]);
          tr.appendChild(td);
        } else {
          // checkbox cell
          const tdCheckbox = document.createElement('td');
          tdCheckbox.className = 'checkbox';
          const cb = document.createElement('input');
          cb.type = 'checkbox';
          const key = prefix + sIdx + '_' + i;
          cb.id = key; // unique id so label can reference it
          try {
            if (localStorage.getItem(key) === '1') cb.checked = true;
          } catch (e) { /* localStorage blocked */ }

          cb.addEventListener('change', function(){
            try {
              if (cb.checked) localStorage.setItem(key, '1');
              else localStorage.removeItem(key);
            } catch(e){}
          });

          tdCheckbox.appendChild(cb);

          // item cell (label clickable)
          const tdItem = document.createElement('td');
          tdItem.className = 'item';
          const lbl = document.createElement('label');
          lbl.className = 'item-label';
          lbl.htmlFor = cb.id;
          lbl.textContent = item[0];
          tdItem.appendChild(lbl);

          // action cell
          const tdAction = document.createElement('td');
          tdAction.className = 'action';
          tdAction.textContent = item[1] || '';

          tr.appendChild(tdCheckbox);
          tr.appendChild(tdItem);
          tr.appendChild(tdAction);
        }

        table.appendChild(tr);
      });

      checklistEl.appendChild(table);
    });
  }

  // Reset-Button
  document.getElementById('resetBtn').addEventListener('click', function(e){
    if (!confirm('Reset all checked items for this checklist?')) return;
    checklistData.forEach((section, sIdx) => {
      section.items.forEach((_, i) => {
        try { localStorage.removeItem(prefix + sIdx + '_' + i); } catch(e){}
      });
    });
    // uncheck visible checkboxes
    checklistEl.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
  });

  // initial render
  if (document.readyState !== 'loading') buildChecklist();
  else document.addEventListener('DOMContentLoaded', buildChecklist);

})();
</script>
</body>
</html>
